<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢</title>
  <style>
    body {
      font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #bc3030;
      color: #333;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      overflow-x: auto;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-top: 0;
    }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 6px; font-weight: bold; }
    input, select, button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    button {
      background-color: #ffd13f;
      color: black;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s;
    }
    button:hover { background-color: #da8012; }

    /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á Desktop */
    .table-wrapper { 
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    table {
      width: 100%;
      min-width: 1300px;
      border-collapse: collapse;
      margin-top: 20px;
      table-layout: auto;
    }
    table th, table td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
      vertical-align: top;
      white-space: normal;
      word-break: break-word;
      overflow-wrap: anywhere;
      hyphens: auto;
    }
    table th {
      background-color: #f9f9f9;
      font-weight: bold;
      line-height: 1.4;
      white-space: normal;
    }

    #adminTableContainer table th:first-child {
      white-space: nowrap;
    }
    .status {
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 4px;
      display: inline-block;
      white-space: nowrap;
    }
    .status.waiting { background-color: #28a745; color: #fff; }
    .status.received { background-color: #007bff; color: #fff; }
    .status.expiring { background-color: #ffa500; color: #fff; }
    .status.expired  { background-color: #dc3545; color: #fff; }

    input[type="date"], input[type="time"] {
      -webkit-appearance: none;
      appearance: none;
      height: 44px;
      padding: 10px 12px;
      font-size: 16px;
      line-height: 1.2;
    }
    input[type="date"]::-webkit-date-and-time-value,
    input[type="time"]::-webkit-date-and-time-value {
      text-align: left;
    }

    /* ========== MOBILE ONLY ========== */
    @media (max-width: 768px) {
      body { padding: 12px; }
      .container {
        padding: 16px;
        overflow-x: visible;
      }

      .form-group { margin-bottom: 12px; }

      #adminTableContainer {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 20px auto 0;
        width: 100%;
        max-width: 100%;
      }
      #adminTableContainer h2 {
        text-align: center;
        width: 100%;
        margin-bottom: 12px;
      }

      #adminTableContainer colgroup { display: none; }

      #adminTableContainer .table-wrapper {
        width: 100%;
        max-width: 100%;
        padding: 0;
        overflow: visible;
        display: flex;
        justify-content: center;
      }

      #adminTableContainer table {
        display: block;
        width: 100% !important;
        min-width: auto;
        max-width: 460px;
        margin: 0 auto;
        border-collapse: separate;
        border-spacing: 0;
      }
      
      #adminTableContainer thead { display: none; }
      #adminTableContainer tbody { display: block; width: 100%; }

      #adminTableContainer tbody tr {
        display: block;
        width: 100%;
        margin: 0 auto 14px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        padding: 12px 14px;
        box-sizing: border-box;
      }

      #adminTableContainer tbody td {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        border: none;
        border-bottom: 1px solid #eee;
        padding: 8px 0;
        text-align: left;
        white-space: normal;
        word-break: break-word;
        overflow-wrap: anywhere;
      }
      #adminTableContainer tbody td:last-child { border-bottom: none; }

      #adminTableContainer tbody td::before {
        content: attr(data-label);
        font-weight: 600;
        color: #666;
        margin-right: 8px;
        min-width: 130px;
        max-width: 130px;
        flex-shrink: 0;
        white-space: normal;
        word-break: break-word;
        line-height: 1.3;
      }

      #adminTableContainer td[data-label^="‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"] img,
      #adminTableContainer td[data-label*="Picture"] img {
        max-width: 72px;
        max-height: 72px;
        object-fit: cover;
      }

      #adminTableContainer td[data-label^="‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"] .status,
      #adminTableContainer td[data-label*="Status"] .status {
        display: inline-block;
        padding: 6px 10px;
      }

      #adminTableContainer td[data-label^="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á"],
      #adminTableContainer td[data-label*="Reporter Details"] {
        flex-direction: column;
        align-items: stretch;
      }

      #adminTableContainer td[data-label^="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á"]::before,
      #adminTableContainer td[data-label*="Reporter Details"]::before {
        margin-bottom: 8px;
      }

      #adminTableContainer td[data-label^="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á"] > div,
      #adminTableContainer td[data-label*="Reporter Details"] > div {
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 4px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      #adminTableContainer td[data-label^="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á"] > div:last-child,
      #adminTableContainer td[data-label*="Reporter Details"] > div:last-child {
        border-bottom: none;
      }

      #adminTableContainer td[data-label^="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á"] strong,
      #adminTableContainer td[data-label*="Reporter Details"] strong {
        color: #666;
        font-weight: 600;
        min-width: 100px;
      }

      #notFoundBox {
        width: 100%;
        max-width: 460px;
        margin: 12px auto 0;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="section" id="searchSection">
      <h1>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢</h1>
      <div class="form-group">
        <label for="searchItemName">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á</label>
        <input type="text" id="searchItemName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤, ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
      </div>
      <div class="form-group">
        <label for="searchLocation">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="text" id="searchLocation" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ SC3, ‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ SC">
      </div>
      <div class="form-group">
        <label for="searchDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="date" id="searchDate">
      </div>
      <div class="form-group">
        <label for="searchDetails">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
        <input type="text" id="searchDetails" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏µ‡∏î‡∏≥, ‡∏°‡∏µ‡∏™‡∏ï‡∏¥‡πä‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î">
      </div>
      <button id="searchBtn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
      

      <div style="margin-top: 20px;">
        <a href="lost.html" style="text-decoration: none;">
          <button style="width: 100%; padding: 10px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; background-color: #ffd13f; color: black; cursor: pointer; font-weight: bold; transition: background-color 0.2s;">
            ‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢
          </button>
        </a>
      </div>
    </div>

    <div id="adminTableContainer" style="margin-top:20px; display:none;">
      <h2>üìã ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h2>
      <div class="table-wrapper">
        <table>
          <colgroup>
            <col style="width:80px">
            <col style="width:120px">
            <col style="width:140px">
            <col style="width:100px">
            <col style="width:140px">
            <col style="width:140px">
            <col style="width:180px">
            <col style="width:120px">
            <col style="width:100px">
            <col style="width:140px">
            <col style="width:180px">
            <col style="width:160px">
            <col style="width:120px">
          </colgroup>
          <thead>
            <tr>
              <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
              <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á (Type)</th>
              <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà / ‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢ (Category)</th>
              <th>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Picture)</th>
              <th>‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ / ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ö‡∏±‡∏ï‡∏£ (Brand)</th>
              <th>‡∏£‡∏∏‡πà‡∏ô / ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£ (Model)</th>
              <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (More Details)</th>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (Date)</th>
              <th>‡πÄ‡∏ß‡∏•‡∏≤ (Time)</th>
              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏ö (Location)</th>
              <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á (Reporter Details)</th>
              <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î (Record)</th>
              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Status)</th>
            </tr>
          </thead>
          <tbody id="adminTableBody"></tbody>
        </table>
      </div>

      <div id="notFoundBox" style="display:none; margin-top:16px; text-align:center;">
        <p style="color:#b22222; font-weight:bold;">‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô</p>
      </div>
    </div>
  </div>

<script>
    // ‚≠êÔ∏è 1. ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Lambda Search Function ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const LAMBDA_SEARCH_URL = "https://vnzvfki24e5re2d6fh3k6bmq2a0ddolc.lambda-url.us-east-1.on.aws/";
    const LIFF_ID = "2008305063-P2NpboxX";

    // ‚≠êÔ∏è 2. ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á Element
    // ‚ÄºÔ∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ID ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô HTML ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô 'searchBtn' ‡∏´‡∏£‡∏∑‡∏≠ 'searchButton')
    const searchButton = document.getElementById("searchBtn"); 
    const resultsContainer = document.getElementById("adminTableBody");
    const notFoundBox = document.getElementById("notFoundBox");
    const container = document.getElementById("adminTableContainer");

    // ‚≠êÔ∏è 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏•‡πâ‡∏ß)
    function renderAdminTable(items) {
      const tbody = document.getElementById("adminTableBody");
      if (!tbody) return;

      const foundItems = items.filter(item => item.item_type === 'FOUND_ITEM');
      foundItems.sort((a, b) => (b.reportTimestamp || '').localeCompare(a.reportTimestamp || ''));

      if (foundItems.length === 0) {
          tbody.innerHTML = `<tr><td colspan="13" style="text-align:center;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
          notFoundBox.style.display = 'block';
          container.style.display = 'block';
          return;
      }

      notFoundBox.style.display = 'none';
      
      tbody.innerHTML = foundItems.map((item, index) => {
        
        // --- ‚úÖ‚úÖ‚úÖ ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: Logic ‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏° BrandInfo ---
        let displayBrandInfo = '';
        if (item.brandInfo) {
            // 1. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô "‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà" ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ brandInfo
            displayBrandInfo = item.brandInfo;
        } else {
            // 2. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô "‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤" (‡πÄ‡∏ä‡πà‡∏ô‡πÉ‡∏ô‡∏£‡∏π‡∏õ) ‡πÉ‡∏´‡πâ‡∏£‡∏ß‡∏° 2 field ‡πÄ‡∏î‡∏¥‡∏°
            const oldBrand = item.brandName || '';
            const oldId = item.itemIdNumber || '';
            
            if (oldBrand && oldId) {
                displayBrandInfo = `${oldBrand} (${oldId})`;
            } else {
                displayBrandInfo = oldBrand || oldId;
            }
        }
        // --- (‡∏à‡∏ö Logic) ---

        const statusClassMap = { 'found_reported': 'waiting', 'claimed': 'received', 'expired': 'expired' };
        const statusTextMap = { 'found_reported': '‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô', 'claimed': '‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß', 'expired': '‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß' };
        const status = item.status || 'found_reported';

        // ‚ÄºÔ∏è ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤ HTML ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß ‚ÄºÔ∏è
        return `
          <tr>
            <td data-label="‡∏•‡∏≥‡∏î‡∏±‡∏ö">${index + 1}</td>
            <td data-label="‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á">
              <span style="display:inline-block;padding:4px 8px;border-radius:4px;font-weight:600;background-color:#dcfce7;color:#166534;">
                ‡∏û‡∏ö‡∏Ç‡∏≠‡∏á
              </span>
            </td>
            <td data-label="‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà">${item.category || "-"}</td>
            <td data-label="‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û">
              ${item.imageUrl ? `<a href="${item.imageUrl}" target="_blank"><img src="${item.imageUrl}" alt="item" style="width:50px;height:50px;object-fit:cover;"></a>` : '‡πÑ‡∏°‡πà‡∏°‡∏µ'}
            </td>
            
            <td data-label="‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡∏£‡∏∏‡πà‡∏ô/‡∏£‡∏´‡∏±‡∏™">${displayBrandInfo || "-"}</td>
            
            <td data-label="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°">${item.details || "-"}</td>
            <td data-label="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏ö">${item.foundDate || "-"}</td>
            <td data-label="‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö">${item.foundTime || "-"}</td>
            <td data-label="‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏ö">${item.foundLocation || "-"}</td>
            <td data-label="‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á">****</td>
            <td data-label="Case ID">
              <span style="color:#6b7280;font-weight:bold;">${item.case_id || 'N/A'}</span>
            </td>
            <td data-label="‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞">
              <span class="status ${statusClassMap[status] || 'waiting'}">${statusTextMap[status] || '‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô'}</span>
            </td>
          </tr>
        `;
      }).join("");
    }

    // ‚≠êÔ∏è 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Lambda
    async function fetchFromLambda(payload) {
      const tbody = document.getElementById("adminTableBody");
      
      tbody.innerHTML = `<tr><td colspan="12" style="text-align:center;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...</td></tr>`; // ‚ÄºÔ∏è ‡∏•‡∏î colspan ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 12
      notFoundBox.style.display = "none";
      container.style.display = "block";
      if(searchButton) searchButton.disabled = true;

      try {
        const response = await fetch(LAMBDA_SEARCH_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (!response.ok) {
            const errData = await response.json();
            throw new Error(errData.error || `HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();

        if (result.status === 'success' && result.count > 0) {
          renderAdminTable(result.items); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        } else {
          renderAdminTable([]); // ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        }
      } catch (error) {
        console.error('Error fetching search results:', error);
        tbody.innerHTML = `<tr><td colspan="12" style="color:red; text-align:center;">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}</td></tr>`; // ‚ÄºÔ∏è ‡∏•‡∏î colspan ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 12
      } finally {
        if(searchButton) searchButton.disabled = false;
      }
    }

    // ‚≠êÔ∏è 5. Event Listener (‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á)
    document.addEventListener('DOMContentLoaded', () => {
        
        if (searchButton) {
            searchButton.addEventListener('click', async () => {
                // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
                const itemName = document.getElementById("searchItemName").value.trim();
                const location = document.getElementById("searchLocation").value.trim();
                const date = document.getElementById("searchDate").value;
                const details = document.getElementById("searchDetails").value.trim();

                // ‡∏£‡∏ß‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏õ‡πá‡∏ô 'keyword' ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
                const keyword = itemName || details;

                const payload = {
                    search_mode: 'user', // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 'user'
                    keyword: keyword || null,
                    location: location || null,
                    date: date || null
                };

                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API
                await fetchFromLambda(payload);
            });
        }
    });
</script>
</body>
</html>
